(this["webpackJsonpnational-data-explorer"]=this["webpackJsonpnational-data-explorer"]||[]).push([[0],{204:function(e,t,r){e.exports=r(395)},209:function(e,t,r){},215:function(e,t,r){},394:function(e,t,r){},395:function(e,t,r){"use strict";r.r(t);var a=r(1),n=r.n(a),c=r(24),o=r.n(c),u=(r(209),r(25)),s=r(158),p=r(75),l=r(173),i=r(19),f={prefectures:{},prefectureNameError:"",prefecturePopulationError:"",prefectureNamesLoading:!0,prefecturePopulationLoading:!1},m=Object(u.combineReducers)({prefectureData:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:f,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"fetch_prefecture_names_processing":return Object(i.a)({},e,{prefectureNameError:"",prefectureNamesLoading:!0});case"fetch_prefecture_names_success":var r=t.prefectureNames.reduce((function(e,t){var r=t.prefName;return e[t.prefCode]={name:r,selected:!1},e}),{});return Object(i.a)({},e,{prefectures:r,prefectureNameError:"",prefectureNamesLoading:!1});case"fetch_prefecture_names_failed":return Object(i.a)({},e,{prefectureNameError:t.error,prefectureNamesLoading:!1});case"prefecture_toggled":var a=Object(i.a)({},e.prefectures);return a[t.prefCode].selected=!a[t.prefCode].selected,Object(i.a)({},e,{prefectures:a});case"fetch_prefecture_population_processing":return Object(i.a)({},e,{prefecturePopulationLoading:!0});case"fetch_prefecture_population_success":var n=Object(i.a)({},e.prefectures);return n[t.prefCode].populationData=t.populationData,Object(i.a)({},e,{prefectures:n,prefecturePopulationError:"",prefecturePopulationLoading:!1});case"fetch_prefecture_population_failed":return Object(i.a)({},e,{prefecturePopulationError:t.error,prefecturePopulationLoading:!1});default:return e}}}),d=r(17),h=r.n(d),b=r(20),v=r(104),g=function(){var e=Object(v.a)(h.a.mark((function e(t){var r,a,n;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r="https://opendata.resas-portal.go.jp/"+t,e.next=3,window.fetch(r,{headers:{"X-API-KEY":"wwODiFgVTGIqdniTXaN6wcvL22lrV8GonHUlIx6B"}});case 3:if(200===(a=e.sent).status){e.next=6;break}throw new Error("".concat(r," \u304b\u3089").concat(a.status,"\u306e\u30ea\u30b9\u30dd\u30f3\u30b9\u304c\u8fd4\u3055\u308c\u307e\u3057\u305f\u3002"));case 6:return e.next=8,a.json();case 8:if((n=e.sent).result){e.next=11;break}throw new Error("".concat(r," \u304b\u3089\u306e\u30ea\u30b9\u30dd\u30f3\u30b9\u306ebody\u306e\u5f62\u5f0f\u304c\u9593\u9055\u3063\u3066\u3044\u307e\u3059\u3002"));case 11:return e.abrupt("return",n.result);case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),E={nationalStatistics:{fetchPrefectureNames:function(){return g("api/v1/prefectures/")},fetchPrefecturePopulation:function(){var e=Object(v.a)(h.a.mark((function e(t,r,a,n){var c,o;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c={total:0,youth:1,productiveAge:2,elderly:3},e.next=3,g("api/v1/population/composition/perYear?cityCode=-&prefCode=".concat(t));case 3:return o=e.sent,e.abrupt("return",o.data[c[r]].data.filter((function(e){var t=e.year;return t>=a&&t<=n})));case 5:case"end":return e.stop()}}),e)})));return function(t,r,a,n){return e.apply(this,arguments)}}()}},_=h.a.mark(x),O=h.a.mark(y),j=h.a.mark(N);function x(){var e;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,E.nationalStatistics.fetchPrefectureNames();case 3:return e=t.sent,t.next=6,Object(b.c)({type:"fetch_prefecture_names_success",prefectureNames:e});case 6:t.next=13;break;case 8:return t.prev=8,t.t0=t.catch(0),t.next=12,Object(b.c)({type:"fetch_prefecture_names_failed",error:"\u30c7\u30fc\u30bf\u53d6\u5f97\u306b\u554f\u984c\u304c\u3042\u308a\u307e\u3057\u305f\u3002\u3057\u3070\u3089\u304f\u3057\u3066\u304b\u3089\u3082\u3046\u4e00\u5ea6\u304a\u8a66\u3057\u304f\u3060\u3055\u3044\u3002"});case 12:console.error(t.t0);case 13:case"end":return t.stop()}}),_,null,[[0,8]])}function y(e){var t,r,a;return h.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(t=e.prefCode,r=e.shouldFetchPopulation,n.prev=1,r){n.next=4;break}return n.abrupt("return");case 4:return n.next=6,Object(b.c)({type:"fetch_prefecture_population_processing"});case 6:return n.next=8,E.nationalStatistics.fetchPrefecturePopulation(t,"total",1970,2020);case 8:return a=n.sent,n.next=11,Object(b.c)({type:"fetch_prefecture_population_success",prefCode:t,populationData:a});case 11:n.next=20;break;case 13:return n.prev=13,n.t0=n.catch(1),n.next=17,Object(b.c)({type:"prefecture_toggled",prefCode:t,shouldFetchPopulation:!1});case 17:return n.next=19,Object(b.c)({type:"fetch_prefecture_population_failed",error:"\u30c7\u30fc\u30bf\u53d6\u5f97\u306b\u554f\u984c\u304c\u3042\u308a\u307e\u3057\u305f\u3002\u3057\u3070\u3089\u304f\u3057\u3066\u304b\u3089\u3082\u3046\u4e00\u5ea6\u304a\u8a66\u3057\u304f\u3060\u3055\u3044\u3002"});case 19:console.error(n.t0);case 20:case"end":return n.stop()}}),O,null,[[1,13]])}function N(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(b.d)("fetch_prefecture_names_processing",x);case 2:return e.next=4,Object(b.d)("prefecture_toggled",y);case 4:case"end":return e.stop()}}),j)}var w=h.a.mark(P);function P(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(b.a)([N].map((function(e){return Object(b.b)(e)})));case 2:case"end":return e.stop()}}),w)}var k=r(21),C=r(71),D=(r(215),r(414)),L=r(413),F=r(416),S=r(415),B=function(e){var t=e.items,r=e.onChange;return n.a.createElement("div",{className:"filter"},Object.entries(t).map((function(e){var t=Object(k.a)(e,2),a=t[0],c=t[1],o=c.selected,u=c.name;return n.a.createElement(F.a,{className:"filter-label",key:"filter-"+a,control:n.a.createElement(S.a,{checked:o,onChange:r,name:a,color:"primary"}),label:u})})))},I=r(29),A=["#0088FE","#00C49F","#FFBB28","#FF8042"],K=function(e){var t=e.chartData,r=e.legendNames,a=e.processing,c=e.messageOnEmpty,o=e.error;return o?n.a.createElement("div",{className:"chart"},o):a?n.a.createElement("div",{className:"chart"},n.a.createElement(L.a,null)):r.length?n.a.createElement("div",{className:"chart"},n.a.createElement(I.e,null,n.a.createElement(I.d,{data:t,margin:{top:5,right:20,left:40,bottom:5}},n.a.createElement(I.a,{strokeDasharray:"3 3"}),n.a.createElement(I.g,{dataKey:"name"}),n.a.createElement(I.h,{tickFormatter:function(e){return e.toLocaleString()}}),n.a.createElement(I.f,{formatter:function(e){return e.toLocaleString()}}),n.a.createElement(I.b,{align:"right",verticalAlign:"top",layout:"vertical"}),r.map((function(e,t){return n.a.createElement(I.c,{dataKey:e,key:"datakey-".concat(e),stroke:A[t%A.length]})}))))):n.a.createElement("div",{className:"chart"},c)},T=function(e){var t=Object.values(e).filter((function(e){return e.populationData})).reduce((function(e,t){var r=t.name;return t.populationData.forEach((function(t){var a=t.value,n=t.year;e[n]=Object(i.a)({},e[n],Object(C.a)({},r,a))})),e}),{});return Object.entries(t).map((function(e){var t=Object(k.a)(e,2),r=t[0],a=t[1];return a.name=r,a}))},G=function(e){var t=e.children;return n.a.createElement(D.a,{className:"data-explorer"},n.a.createElement("h3",null,"\u90fd\u9053\u5e9c\u770c"),n.a.createElement("div",{className:"data-explorer-contents"},t))},J={fetchPrefectureNames:function(){return{type:"fetch_prefecture_names_processing"}},togglePrefecture:function(e,t){return{type:"prefecture_toggled",prefCode:e,shouldFetchPopulation:t}}},M=Object(p.b)((function(e){return e.prefectureData}),J)((function(e){var t=e.prefectures,r=e.prefectureNamesLoading,c=e.prefecturePopulationLoading,o=e.prefectureNameError,u=e.prefecturePopulationError,s=e.fetchPrefectureNames,p=e.togglePrefecture;return Object(a.useEffect)((function(){s()}),[s]),o?n.a.createElement(G,null,o):r?n.a.createElement(G,null,n.a.createElement(L.a,null)):n.a.createElement(G,null,n.a.createElement(B,{items:t,onChange:function(e){var r=e.target.name;p(r,!t[r].populationData)}}),n.a.createElement(K,{chartData:T(t),legendNames:Object.values(t).filter((function(e){return e.selected})).map((function(e){return e.name})),processing:c,messageOnEmpty:"\u90fd\u9053\u5e9c\u770c\u3092\u9078\u629e\u3057\u3066\u304f\u3060\u3055\u3044\u3002",error:u}))})),V=(r(394),Object(l.a)()),X=Object(u.createStore)(m,Object(s.composeWithDevTools)(Object(u.applyMiddleware)(V)));V.run(P);var Y=function(){return n.a.createElement(p.a,{store:X},n.a.createElement("div",{className:"app"},n.a.createElement("h1",null,"\u90fd\u9053\u5e9c\u770c\u5225\u306e\u7dcf\u4eba\u53e3\u63a8\u79fb\u30b0\u30e9\u30d5"),n.a.createElement(M,null)))},q=r(172);o.a.render(n.a.createElement(n.a.StrictMode,null,n.a.createElement(q.a,{basename:"/todouhuken_test"},n.a.createElement(Y,null))),document.getElementById("root"))}},[[204,1,2]]]);
//# sourceMappingURL=main.cf8c1b0b.chunk.js.map